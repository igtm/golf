# Golf AI - 次世代スイング解析エージェント PRD (製品要求仕様書)

## 1. プロダクトコンセプト
**「スマホひとつで、あなたのポケットに専属プロコーチを。」**
Golf AIは、単なる動画再生・線引きツールではありません。エッジAI（端末内処理）を駆使し、スイングの「構造」と「課題」を瞬時に理解・可視化する、次世代のゴルフ練習パートナーです。

## 2. アプリの独自の強み (Unique Selling Propositions)

### ① 完全自動の「プロ視点」解析 (Zero-Config Analysis)
ユーザーが手動で線を引いたり、動画をコマ送りしてインパクトを探す必要はありません。AIがスイング動画を読み込んだ瞬間、以下の処理を全自動で行います。
*   **スイング区間の自動トリミング**: 構えてから打ち終わるまでだけを自動抽出。
*   **フェーズ特定**: アドレス、テイクバック、トップ、インパクト、フォロースルーを自動でタグ付け。
*   **ガイドライン自動描画**: スイングプレーン（Vゾーン）、ヘッド軌道、身体の軸を自動でオーバーレイ表示。

### ② 「しなり」まで見える物理挙動解析 (Physics & Dynamics)
従来の棒線（スケルトン）表示に加え、最新のセグメンテーションAI技術により、**「クラブシャフトのしなり（Flex）」** まで検知・可視化します。
*   タメ（Lag）が作れているか
*   インパクトで適切にシャフトがリリース（逆しなり）されているか
これらを可視化できるのは、本アプリだけの強力な武器です。

### ③ プライバシーファースト & 爆速レスポンス (Edge AI Architecture)
動画データをサーバーにアップロードしません。全てのAI解析はユーザーのブラウザ（端末）内で行われます（WebGPU対応）。
*   **安心**: プライベートな練習動画が流出するリスクはゼロ。
*   **高速**: 通信待ち時間なし。撮ってすぐ解析。
*   **低コスト**: ギガ（通信量）を消費しません。

### ④ 選べる撮影アングル (Camera Angles)
撮影時に2つのモードを選択できるようにします。
*   **後方 (Down the Line)**: 飛球線後方から撮影。スイングプレーン（Vゾーン）、前傾姿勢のチェックに最適。
*   **正面 (Face On)**: 身体の正面から撮影。スウェイ（左右のブレ）、コックのタメ、リリースのタイミングのチェックに最適。

---

## 3. 実装予定機能 (Ideal Features Roadmap)

### Phase 1: スマート・スイング認識 (Context Awareness)
*   **スイングフェーズ分類機能**:
    *   Roboflow Class 1-7 データセットを活用。
    *   動画内の「構え」「テイクバック」「トップ」「インパクト」「フィニッシュ」をフレーム単位で分類。
    *   機能: 「インパクトの瞬間を見たい」ボタン一つで、そのフレームへジャンプ。
*   **オートトリミング**:
    *   練習場の長い動画から、スイングしている部分だけを自動で切り抜き保存。

### Phase 2: Vゾーン・コンサルタント (Swing Plane Analysis)
*   **理想のプレーン可視化**:
    *   アドレス時のシャフトラインと、首からボールへのラインを結んだ「Vゾーン」を自動描画。
*   **軌道診断アラート**:
    *   スイング軌跡（赤線）がVゾーンから外れた場合、即座に判定。
    *   「Out-In (スライス軌道警告)」「Under Plane (フック/ダフリ警告)」などをポップアップ表示。

### Phase 3: ボディ・スタビリティ解析 (Biomechanics)
*   **スパインアングル（前傾）維持率**:
    *   アドレス時の背骨の角度を基準（ゼロ）とし、インパクトでの起き上がり度合いを「+5°」のように数値化。
    *   許容範囲を超えたら赤色表示。
*   **ヘッドムーブメント（スウェイ/突っ込み）**:
    *   頭の位置をトラッキングし、円（セーフティゾーン）を表示。
    *   インパクト時にゾーンから頭が飛び出している（突っ込んでいる）場合のアラート。

### Phase 4: シャフト・ダイナミクス (Shaft Flex Analysis)
*   **シャフトしなり検知**:
    *   Polygon Segmentation AIを活用し、シャフトの曲率を計算。
    *   トップからの切り返しでの「シャフトのタメ」をヒートマップ（色）で表現（例：負荷がかかっている部分は赤く表示）。
*   **テンポ解析**:
    *   バックスイングとダウンスイングの時間比率（例：3:1）を自動計測。

---

## 4. ターゲットユーザー
1.  **向上心のあるアマチュアゴルファー**:
    *   自分のスイングを客観的に見たいが、どこを見ればいいかわからない層。
    *   練習場で毎回動画を撮るが、見返すのが面倒（トリミングが手間）な層。
2.  **ゴルフコーチ・レッスンプロ**:
    *   生徒のスイングをその場で撮影し、説得力のあるデータを提示したいプロ。
    *   「感覚」だけでなく「数値・視覚」で指導したい指導者。

## 5. 技術スタック (Technical Approach)
*   **Frontend**: React, TypeScript, Vite
*   **AI Inference**: ONNX Runtime Web (WebGPU / WASM)
*   **Models**:
    *   **Pose Estimation**: MediaPipe (Body landmarks)
    *   **Club Detection**: YOLOv8-Seg (Shaft & Head Polygon)
    *   **Phase Classification**: YOLOv8-Cls (Swing Phase Detection)
*   **Storage**: IndexedDB (Local storage for privacy)
